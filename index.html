<!DOCTYPE html>
<html>
<head>
    <link rel="manifest" href="app.webmanifest">
<link rel="icon" href="icon-512.png">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<meta name="theme-color" content="#007aff">
<meta name="apple-mobile-web-app-capable" content="yes">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–º–Ω—ã–π –ö–æ–Ω—Å–ø–µ–∫—Ç–∞—Ç–æ—Ä</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; padding: 20px; background: #f5f5f7; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        h1 { color: #1d1d1f; margin-bottom: 20px; }
        textarea { width: 100%; height: 120px; padding: 16px; border: 2px solid #d1d1d6; border-radius: 12px; font-size: 16px; margin-bottom: 20px; resize: vertical; }
        .buttons { display: flex; gap: 12px; margin-bottom: 24px; }
        button { flex: 1; padding: 14px; background: #007aff; color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 500; cursor: pointer; }
        button:hover { background: #0056cc; }
        .output { min-height: 100px; padding: 20px; background: #f8f8fa; border-radius: 12px; border: 2px dashed #c7c7cc; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß† –£–º–Ω—ã–π –ö–æ–Ω—Å–ø–µ–∫—Ç–∞—Ç–æ—Ä</h1>
        <textarea placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –º—ã—Å–ª–∏, —Ç–µ–∫—Å—Ç –∏–ª–∏ –∏–¥–µ–∏..."></textarea>
        <div class="buttons">
            <button onclick="showResult('–∫–æ–Ω—Å–ø–µ–∫—Ç')">üìù –°–¥–µ–ª–∞—Ç—å –∫–æ–Ω—Å–ø–µ–∫—Ç</button>
            <button onclick="showResult('—É–ª—É—á—à–∏—Ç—å')">‚ú® –£–ª—É—á—à–∏—Ç—å —Ç–µ–∫—Å—Ç</button>
            <button onclick="showResult('–∏–¥–µ–∏')">üí° –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∏</button>
        </div>
        <div class="output" id="output">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ò–ò.</div>
    </div>
    <script>
        async function showResult(action) {
    const text = document.querySelector('textarea').value.trim();
    const output = document.getElementById('output');
    
    if (!text) {
        output.innerHTML = '<p style="color: #ff3b30;">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç.</p>';
        return;
    }
    
    output.innerHTML = '<p>‚åõ –ò–ò –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç...</p>';
    
    try {
        // URL —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–∫—Å–∏ –Ω–∞ Vercel
        const PROXY_URL = 'https://gemini-proxy-7ydu5964i-vf12776-uxs-projects.vercel.app/api/proxy';
        
        const response = await fetch(PROXY_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                prompt: `${getPromptByAction(action)}: ${text}`
            }),
        });
        
        const data = await response.json();
        
        if (data.response) {
            output.innerHTML = `<p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong></p><p>${data.response}</p>`;
        } else if (data.error) {
            output.innerHTML = `<p style="color: #ff3b30;">–û—à–∏–±–∫–∞: ${data.error}</p>`;
        } else {
            output.innerHTML = `<p style="color: #ff3b30;">–°—Ç—Ä–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: ${JSON.stringify(data)}</p>`;
        }
    } catch (error) {
        output.innerHTML = `<p style="color: #ff3b30;">–°–µ—Ç—å: ${error.message}</p>`;
    }
}

function getPromptByAction(action) {
    const prompts = {
        '–∫–æ–Ω—Å–ø–µ–∫—Ç': '–°–¥–µ–ª–∞–π —á—ë—Ç–∫–∏–π –∫–æ–Ω—Å–ø–µ–∫—Ç',
        '—É–ª—É—á—à–∏—Ç—å': '–£–ª—É—á—à–∏ —Å—Ç–∏–ª—å –∏ –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å',
        '–∏–¥–µ–∏': '–ü—Ä–µ–¥–ª–æ–∂–∏ 5 –∏–¥–µ–π'
    };
    return prompts[action] || '–û–±—Ä–∞–±–æ—Ç–∞–π';
}
        </script>
    <button id="installButton" style="display: none; padding: 12px 24px; background: #4CAF50; color: white; border: none; border-radius: 8px; font-size: 16px; margin: 20px auto; cursor: pointer; display: block;">
    üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
</button>

<script>
if ('BeforeInstallPromptEvent' in window) {
    let deferredPrompt;
    const installButton = document.getElementById('installButton');
    
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installButton.style.display = 'block';
        console.log('PWA –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∞');
    });
    
    installButton.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª: ${outcome}`);
        deferredPrompt = null;
        installButton.style.display = 'none';
    });
    
    window.addEventListener('appinstalled', () => {
        console.log('PWA —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        installButton.style.display = 'none';
        deferredPrompt = null;
    });
} else {
    console.log('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É PWA');
    document.getElementById('installButton').style.display = 'none';
}
</script>
</body>
</html>
